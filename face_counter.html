<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vision Blocks</title>

  <link rel="shortcut icon" href="./img/favicon.png">
  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/bootstrap-responsive.css">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/block/block-area.css">
</head>

<body>
  <div class="wrapper">

  <div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
        <a class="brand" href="./index.html">Vision Blocks</a>
        <div class="nav-collapse collapse">
          <ul class="nav">
            <li><a href="./index.html">Home</a></li>
            <li class="active"><a href="./create.html">Create</a></li>
            <li><a href="./about.html">About</a></li>
            <li><a href="./contact.html">Contact</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">More <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li class="nav-header">Main Contributors</li>
                <li><a href="http://cameraculture.media.mit.edu">Camera Culture Group</a></li>
                <li><a href="http://web.media.mit.edu/~raskar/">Ramesh Raskar</a></li>
                <li><a href="http://web.media.mit.edu/~clwen/">Chunglin Wen</a></li>
                <li class="divider"></li>
                <li class="nav-header">Resources</li>
                <li><a href="https://github.com/clwen/Vision-Blocks">Vision Blocks @ github</a></li>
                <li class="divider"></li>
                <li class="nav-header">Acknowledgement</li>
                <li><a href="http://www.media.mit.edu/">MIT Media Lab</a></li>
                <li><a href="http://scratch.mit.edu/">Inspired by Scratch</a></li>
              </ul>
            </li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
  </div>


  <div class="body-area">

    <div class="row">
      <div class="span12">
        <div class="row">

          <div class="span4 block-area">
            <div class="block-area-container">
              <div class="block-container block-container-start" data-title="Start" >
                <div class="icon icon-start"></div>
                
                <div class="block-container-content">
                  
                  <div id="block-play" class="build-block block-container-start build-block-1" data-block-name="play" >
                    <div class="build-block-title-wrapper build-block-recalc-width">
                      <div class="build-block-title">
                        <div class="icon1-build-block icon1-play"></div>
                        <span>Play</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-top"></div>
                    <div class="content">
                      <div class="build-block-1-leftbar"></div>
                    </div>
                    <div class="build-block-bottom build-block-recalc-width"></div>
                    <div class="build-block-1-bottom-fill build-block-recalc-width"></div>
                  </div>
                
                  <div id="block-play-forever" class="build-block block-container-start build-block-1" data-block-name="playForever" >
                    <div class="build-block-title-wrapper build-block-recalc-width">
                      <div class="build-block-title">
                        <div class="icon1-build-block icon1-play-forever"></div>
                        <span>Play Forever</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-top"></div>
                    <div class="content">
                      <div class="build-block-1-leftbar"></div>
                      <div class='build-block empty-block'></div>
                    </div>
                    <div class="build-block-bottom build-block-recalc-width"></div>
                    <div class="build-block-1-bottom-fill build-block-recalc-width"></div>
                  </div>
                  
                </div>
                
              </div>
              <div class="block-container block-container-source" data-title="Source" >
                <div class="icon icon-video"></div>
                
                <div class="block-container-content">

                  <div class="build-block build-block-remote-img block-container-source build-block-2" data-block-name="remoteImage">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-load-image"></div>
                        <span>Remote Image</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>
                
                  <div id="block-upload-img" class="build-block build-block-load-image block-container-source build-block-2" data-block-name="loadImage">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-load-image"></div>
                        <span>Upload Image</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>
                  
                  <div id="block-remote-video" class="build-block build-block-remote-video block-container-source build-block-2" data-block-name="remoteVideo">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-load-video"></div>
                        <span>Remote Video</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>
                
                  <div id="block-upload-video" class="build-block build-block-load-video block-container-source build-block-2" data-block-name="loadVideo">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-load-video"></div>
                        <span>Upload Video</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>
                  
                  <div id="block-webcam" class="build-block block-container-source build-block-2" data-block-name="loadWebcam">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-webcam"></div>
                        <span>Webcam</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>
                
                  <div id="block-foodcam" class="build-block block-container-source build-block-2" data-block-name="loadFoodcam">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-webcam"></div>
                        <span>Foodcam</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>

                </div>
                
              </div>
              <div class="block-container block-container-vision" data-title="Vision">
                <div class="icon icon-vision"></div>
                
                <div class="block-container-content">
                  
                  <div id="block-invert-color" class="build-block block-container-vision build-block-2" data-block-name="invertFilter">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-fake"></div>
                        <span>Invert Color</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>

                  <div id="block-binarize" class="build-block build-block-binarize block-container-vision build-block-2" data-block-name="binarizeFilter">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-fake"></div>
                        <span>Binarize</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>
                  
                  <div id="block-grayscale" class="build-block block-container-vision build-block-2" data-block-name="grayscaleFilter">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-fake"></div>
                        <span>Grayscale</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>
                  
                  <div id="block-pixelization" class="build-block build-block-pixelization block-container-vision build-block-2" data-block-name="pixelization">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-fake"></div>
                        <span>Pixelization</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>

                  <div id="block-color-detect" class="build-block build-block-color-detect block-container-vision build-block-2" data-block-name="colorDetection">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-fake"></div>
                        <span>Color Detection</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>

                  <div id="block-blur" class="build-block build-block-blur block-container-vision build-block-2" data-block-name="blurFilter">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-distortion"></div>
                        <span>Blur</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>
                  
                  <div id="block-distortion" class="build-block block-container-vision build-block-2" data-block-name="distortionFilter">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-distortion"></div>
                        <span>Distortion</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>
                  
                  <div id="block-skin-detect" class="build-block build-block-skin-detection block-container-vision build-block-2" data-block-name="skinDetection">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-detect-face"></div>
                        <span>Skin Detection</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>

                  <div class="build-block build-block-detect-face block-container-vision build-block-2" data-block-name="faceDetection">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-detect-face"></div>
                        <span>Face Detection</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>
                  
                  <div id="block-motion-detect" class="build-block build-block-detect-intrusion block-container-vision build-block-2" data-block-name="intrusionDetection">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-detect-face"></div>
                        <span>Motion Detection</span>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>
                  
                </div>
                
              </div>
              <div class="block-container block-container-logic" data-title="Logic" >
                <div class="icon icon-logic"></div>
                
                <div class="block-container-content">
                  <div class="build-block block-container-logic build-block-if build-block-extra-popover build-block-1 build-block-3" data-block-name="ifBlock">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-title-wrapper build-block-recalc-width">
                      <div class="build-block-title">
                        <div class="icon1-build-block icon1-if"></div>
                        <span>IF</span>
                        <div class="icon-remove-block"></div>
                        <div class="build-block-desc">
                          <span>faces &gt; 0</span>
                        </div>
                      </div>
                    </div>
                    <div class="build-block-top"></div>
                    <div class="content">
                      <div class="build-block-1-leftbar-container">
                        <div class="build-block-1-leftbar"></div>
                      </div>
                    </div>
                    <div class="build-block-bottom build-block-recalc-width"></div>
                    <div class="build-block-1-bottom-fill build-block-recalc-width"></div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>
                </div>
                
              </div>
              <div class="block-container block-container-move" data-title="Move" >
                <div class="icon icon-move"></div>
              </div>
              <div class="block-container block-container-draw" data-title="Draw" >
                <div class="icon icon-draw"></div>
                
                <div class="block-container-content">

                  <div class="build-block build-block-draw-regions block-container-draw build-block-2" data-block-name="drawRegions">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-draw-rect"></div>
                        <div class="build-block-draw-rect-condition">
                          <div class="build-block-draw-rect-condition-rgb">
                            <span>Draw Rect</span>
                          </div>
                        </div>
                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>

                  <div id="block-write-text" class="build-block build-block-write-text block-container-draw build-block-2" data-block-name="writeText">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-draw-rect"></div>
                        <div class="build-block-write-text-condition">
                          <div class="build-block-write-text-condition-text">
                            <span>Text</span>
                          </div>
                        </div>

                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>

                </div>
                
              </div>
              <div class="block-container block-container-alert" data-title="Alert" >
                <div class="icon icon-alert"></div>

                <div class="block-container-content">
                  <div id="block-browser-alert" class="build-block build-block-browser-alert block-container-alert build-block-2" data-block-name="browserAlert">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-draw-rect"></div>
                        <div class="build-block-write-text-condition">
                          <div class="build-block-write-text-condition-text">
                            <span>Browser Alert</span>
                          </div>
                        </div>

                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>
                </div>

                <div class="block-container-content">
                  <div id="block-os-alert" class="build-block build-block-os-alert block-container-alert build-block-2" data-block-name="osAlert">
                    <div class="build-block-2-top build-block-recalc-width"></div>
                    <div class="build-block-2-title-wrapper build-block-recalc-width">
                      <div class="build-block-2-title">
                        <div class="icon1-build-block icon1-draw-rect"></div>
                        <div class="build-block-write-text-condition">
                          <div class="build-block-write-text-condition-text">
                            <span>Desktop Alert</span>
                          </div>
                        </div>

                        <div class="icon-remove-block"></div>
                      </div>
                    </div>
                    <div class="build-block-2-bottom build-block-recalc-width"></div>
                  </div>
                </div>

              </div>
              <div class="block-container block-container-more" data-title="More">
                <div class="icon icon-more"></div>
              </div>
            </div>
            <div class="block-area-options" style="display: none">
            </div>
          </div>

          <div class="span5 build-area">
            <div id="block-play" class="build-block block-container-start build-block-1" data-block-name="play" style="">
              <div class="build-block-title-wrapper build-block-recalc-width" style="width: 194px;">
                <div class="build-block-title">
                  <div class="icon1-build-block icon1-play"></div>
                  <span class="play-title">Play</span>
                  <div class="icon-remove-block"></div>
                </div>
              </div>
              <div class="build-block-top"></div>
              <div class="content" style="height: 166px;">
                <div class="build-block-1-leftbar" style="height: 187px;"></div>
                <div id="block-remote-img" class="build-block build-block-remote-img block-container-source build-block-2" data-block-name="remoteImage" style="top: -20px; left: 12px;">
                  <div class="build-block-2-top build-block-recalc-width" style="width: 182px;"></div>
                  <div class="build-block-2-title-wrapper build-block-recalc-width popover-enable" style="width: 182px;" data-original-title="">
                    <div class="build-block-2-title">
                      <div class="icon1-build-block icon1-load-image"></div>
                      <span>Remote Image</span>
                      <div class="icon-remove-block"></div>
                    </div>
                  </div>
                  <div class="build-block-2-bottom build-block-recalc-width" style="width: 182px;"></div>
                  </div>
                  <div id="block-face-detect" class="build-block build-block-detect-face block-container-vision build-block-2" data-block-name="faceDetection" style="top: -28px; left: 12px;">
                  <div class="build-block-2-top build-block-recalc-width" style="width: 182px;"></div>
                  <div class="build-block-2-title-wrapper build-block-recalc-width popover-enable" style="width: 182px;" data-original-title="">
                    <div class="build-block-2-title">
                      <div class="icon1-build-block icon1-detect-face"></div>
                      <span>Face Detection</span>
                      <div class="icon-remove-block"></div>
                    </div>
                  </div>
                  <div class="build-block-2-bottom build-block-recalc-width" style="width: 182px;"></div>
                  </div>
                  <div id="block-if" class="build-block block-container-logic build-block-if build-block-extra-popover build-block-1 build-block-3" data-block-name="ifBlock" style="top: -36px; left: 12px;">
                  <div class="build-block-2-top build-block-recalc-width" style="width: 182px;"></div>
                  <div class="build-block-title-wrapper build-block-recalc-width popover-enable" style="width: 182px;" data-original-title="">
                    <div class="build-block-title">
                      <div class="icon1-build-block icon1-if"></div>
                      <span>IF</span>
                      <div class="icon-remove-block"></div>
                      <div class="build-block-desc">
                        <span>faces  &gt; 0</span>
                      </div>
                    </div>
                  </div>
                  <div class="build-block-top"></div>
                  <div class="content" style="height: 20px;">
                    <div class="build-block-1-leftbar-container">
                      <div class="build-block-1-leftbar" style="height: 41px;"></div>
                    </div>
                    <div id="block-draw-rect" class="build-block build-block-draw-regions block-container-draw build-block-2" data-block-name="drawRegions" style="top: -20px; left: 12px;">
                      <div class="build-block-2-top build-block-recalc-width" style="width: 170px;"></div>
                      <div class="build-block-2-title-wrapper build-block-recalc-width popover-enable" style="width: 170px;" data-original-title="">
                        <div class="build-block-2-title">
                          <div class="icon1-build-block icon1-draw-rect"></div>
                          <div class="build-block-draw-rect-condition">
                            <div class="build-block-draw-rect-condition-rgb">
                              <span>Draw Rect</span>
                            </div>
                          </div>
                          <div class="icon-remove-block"></div>
                        </div>
                      </div>
                      <div class="build-block-2-bottom build-block-recalc-width" style="width: 170px;"></div>
                  </div></div>
                  <div class="build-block-bottom build-block-recalc-width" style="width: 182px;"></div>
                  <div class="build-block-1-bottom-fill build-block-recalc-width" style="width: 182px;"></div>
                  <div class="build-block-2-bottom build-block-recalc-width" style="width: 182px;"></div>
              </div></div>
              <div class="build-block-bottom build-block-recalc-width" style="width: 194px;"></div>
              <div class="build-block-1-bottom-fill build-block-recalc-width" style="width: 194px;"></div>
            </div>
          </div>

          <div class="span1">
            <div class="row-fluid">
              <div class="span12">
                <div class="well output-area">
                  <div id="canvas-title">
                    <h5>Output</h5>
                  </div>
                  <div id="outputDiv">
                    <video id="inputVideoCam" width="640" height="480"></video>
                    <video id="inputVideo" width="640" height="480"></video>
                    <canvas id="outputCanvas" width="640" height="480"></canvas>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div> <!-- /body-area -->
  <div class="push"></div>
  </div> <!-- /wrapper -->

  <div class="footer">
    <div class="footer-content">
      Best viewed with the latest <a href"https://www.google.com/intl/en/chrome/browser/">Google Chrome</a>.
    </div>
  </div>

  <!-- JAVASCRIPT -->
  <script src="js/libs/jquery-1.8.3.js"></script>
  <script src="js/libs/bootstrap.js"></script>
  <script src="js/libs/bootstrap-popover.js"></script>
  <script src="js/libs/ocanvas-2.1.0.min.js"></script>
  <script src="js/libs/haar-detector.js"></script>
  <script src="js/libs/cascades/haarcascade_frontalface_alt.js"></script>
  <script src="js/libs/eventemitter2.js"></script>
  <script src="js/libs/mjpegcanvas.js"></script>

  <script src="js/auxiliary.js"></script>
  <script src="js/main.js"></script>
  <script src="js/model.js"></script>
  <script src="js/blocks_filter.js"></script>
  <script src="js/blocks_vision.js"></script>
  <script src="js/blocks_load.js"></script>
  <script src="js/blocks_flow.js"></script>
  <script src="js/blocks_conditional_flow.js"></script>

  <script src="js/block/block-area.js"></script>
  <script src="js/block/drag-and-drop.js"></script>
  <script src="js/block/apply-popover.js"></script>

  <script>
    $(document).ready(function() {
      $("#block-remote-img").find(".build-block-2-title-wrapper:first").applyPopover({
        'popover': {
          content: function() {
            var html = "<div class='build-block-remote-img-popover'>";
              html += "<div class='build-block-remote-img-popover-top'>";
              html += "<div>URL</div> <div><input id='remote-img-url' class='enter-out-popover'/></div>";
              html += "</div>";
              html += "</div>";

            return html;
          }
        },
        'block-options': {
          'remoteImgUrl': 'http://vblocks.media.mit.edu/files/mona_lisa.jpg',
        },
        'shown-event': function(blockOptions) {
          $("#remote-img-url").val(blockOptions['remoteImgUrl']);
        },
        'hidden-event': function(blockOptions) {
          blockOptions['remoteImgUrl'] = $("#remote-img-url").val();
        }
      });

      $("#block-face-detect").find(".build-block-2-title-wrapper:first").applyPopover({
        'popover': {
          contentFooter: function() {
            var html = "";
            html += "<div class='output_element'><span>faces</span></div>";
            html += "<div class='output_element'><span>faces_array</span></div>";
            html += "<div class='output_element'><span>faceX</span></div>";
            html += "<div class='output_element'><span>faceY</span></div>";
            html += "<div class='output_element'><span>faceW</span></div>";
            html += "<div class='output_element'><span>faceH</span></div>";

            return html;
          }
        },
        'shown-event': function(blockOptions) {
          $("#load-image-url").val(blockOptions['url']);
          $(".popover-footer-content > div").dragAndDrop({
            end: function(element) {
              var blockIf = $(".build-area .build-block-if:eq(0)");
              if (blockIf) {
                blockIf.data("block-options")['entry'] = element.text();
                blockIf.find(".build-block-desc:eq(0) span").text(element.text() + " " +blockIf.data("block-options")['condition']);
              }
            }
          });
        },
        'hidden-event': function(blockOptions) {
          blockOptions['url'] = $("#load-image-url").val();
        }
      });

      $("#block-if").find(".build-block-title-wrapper:first").applyPopover({
        'popover': {
          content: function() {
            var html = "<div class='build-block-if-popover'>";
              html += "<div class='build-block-if-popover-top'>";
              html += "<div>Variable</div> <div><input id='if-popover-entry' value='faces' class='enter-out-popover'/></div>";
              html += "<br/>";
              html += "<div>Condition</div> <div><input id='if-popover-condition' value='> 0' class='enter-out-popover'/></div>";
              html += "</div>";
              html += "<div class='build-block-if-popover-bottom'>";
              html += "<div id='if-popover-final-condition'><span></span></div>";
              html += "</div>";
              html += "</div>";

            return html;
          }
        },
        'block-options': {
          'condition': ' > 0',
          'entry': 'faces'
        },
        'shown-event': function(blockOptions) {
          if (blockOptions['entry'] != null) {
            $("#if-popover-entry").val(blockOptions['entry']);
          }
          if (blockOptions['condition'] != null) {
            $("#if-popover-condition").val(blockOptions['condition']);
          }
          $("#if-popover-condition").change(function(){
            var ifCondition = blockOptions['entry'] + " " + blockOptions['condition'];
            $("#if-popover-final-condition span").text(ifCondition);
            $("#block-if").find(".build-block-desc:eq(0) span").text(ifCondition);
          });
          $("#if-popover-condition").change();
        },
        'hidden-event': function(blockOptions) {
          blockOptions['condition'] = $("#if-popover-condition").val();
          blockOptions['entry'] = $("#if-popover-entry").val();
        }
      });

      $("#block-draw-rect").find(".build-block-2-title-wrapper:first").applyPopover({
        'popover': {
          content: function() {
            var html = "<div class='build-block-draw-region-popover'>";
              html += "<div class='build-block-draw-region-popover-top'>";
                html += "<div>RGB</div> <div><input id='draw-regions-popover-color' maxlength='6' class='enter-out-popover'/></div>";
                html += "<div>Boxes</div> <div><input id='draw-regions-popover-boxes' class='enter-out-popover'/></div>";
                html += "</div>";
              html += "</div>";

            return html;
          }
        },
        'block-options': {
          'rgb': 'FF0000',
          'boxes': 'faces_array'
        },
        'shown-event': function(blockOptions) {
          $("#draw-regions-popover-color").val(blockOptions['rgb']);
          $("#draw-regions-popover-boxes").val(blockOptions['boxes']);
        },
        'hidden-event': function(blockOptions) {
          blockOptions['rgb'] = $("#draw-regions-popover-color").val();
          blockOptions['boxes'] = $("#draw-regions-popover-boxes").val();

          if (blockOptions['rgb']) {
            $("#block-draw-rect").find(".build-block-draw-rect-condition-rgb").css("background-color", '#'+blockOptions['rgb']);
          }
        }
      });

    });
  </script>

</body>
</html>
